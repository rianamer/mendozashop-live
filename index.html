<!DOCTYPE html>
<html lang="id" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mendoza Shop</title>
    <link rel="icon" type="image/png" href="https://i.ibb.co/qDGrncf/logo.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>if(localStorage.getItem('theme')==='light')document.documentElement.classList.remove('dark');else document.documentElement.classList.add('dark');</script>
    <style>
        body { font-family: 'Inter', sans-serif; background: #f3f4f6; }
        .dark body { background-color: #0f172a; } .dark header, .dark footer, .dark .bg-white { background-color: #1e293b; }
        .dark h1, .dark h2, .dark h3, .dark h4 { color: #e2e8f0; } .dark p, .dark label, .dark span { color: #cbd5e1; }
        .dark .text-gray-600, .dark .text-gray-500 { color: #94a3b8; }
        .dark .border, .dark .border-b, .dark .border-t { border-color: #334155; }
        .dark .filter-btn { background-color: #334155; color: #cbd5e1; } .dark .filter-btn.active { background-color: #3b82f6; border-color: #3b82f6; color: white; }
        .dark .payment-option { background-color: #334155; border-color: #475569; } .dark .payment-option.selected { background-color: #374151; border-color: #3b82f6; }
        .modal-backdrop { background-color: rgba(0,0,0,0.6); } .modal { transition:transform 0.3s,opacity 0.3s; }
        .modal.hidden { transform:scale(0.95); opacity:0; pointer-events:none; }
        .loader { width: 48px; height: 48px; border: 5px solid #FFF; border-bottom-color: transparent; border-radius: 50%; display: inline-block; animation: rotation 1s linear infinite; } @keyframes rotation { to { transform: rotate(360deg); } }
        .main-image-wrapper { position: relative; } .image-nav-btn { position: absolute; top: 50%; transform: translateY(-50%); background-color:rgba(0,0,0,0.4); color: white; border-radius: 50%; width: 40px; height: 40px; z-index:10; font-size: 24px; line-height: 0; display: flex; align-items: center; justify-content: center; }
        .thumbnail-image { opacity: 0.6; cursor: pointer; border: 2px solid transparent; } .thumbnail-image.active { opacity: 1; border-color: #3b82f6; }
    </style>
</head>
<body class="text-gray-800 dark:text-gray-300">
    <header class="bg-white shadow-md sticky top-0 z-40"><div class="container mx-auto px-6 py-4 flex justify-between items-center"><a href="#"><img src="https://i.postimg.cc/fyBrZht2/Gemini-Generated-Image-7nos987nos987nos-1.png" alt="Mendoza Shop Logo" class="h-16 w-auto"></a><div class="flex items-center space-x-2 sm:space-x-4"><button id="theme-toggle" data-action="toggle-theme" class="p-2 rounded-full"><svg class="h-6 w-6" id="theme-icon-container"><use href="#icon-moon"/></svg></button><button data-action="open-cart" class="relative p-2"><i class="fas fa-shopping-cart text-2xl text-gray-600 dark:text-gray-300"></i><span id="cart-count" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center">0</span></button></div></div></header>
    <main class="container mx-auto px-6 py-8"><section class="mb-4"><h2 class="text-2xl font-bold mb-4">Kategori</h2><div id="category-filters" class="flex flex-wrap gap-2"></div></section><section id="subcategory-section" class="mb-8 hidden"><h3 id="subcategory-title" class="text-xl font-semibold mb-3"></h3><div id="subcategory-filters" class="flex flex-wrap gap-2"></div></section><section><h2 id="product-section-title" class="text-2xl font-bold mb-4"></h2><div id="product-grid" class="grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 sm:gap-6"><div id="loading-state" class="col-span-full flex flex-col items-center p-12 text-center"><div class="loader mb-4"></div><p class="text-lg font-semibold">Memuat produk...</p></div></div></section></main>
    <footer class="bg-white mt-12 py-8"><div class="container mx-auto px-6 text-center"><p class="text-gray-600 dark:text-gray-400">© 2025 Mendoza Shop.</p></div></footer>
    <div id="modal-container"></div>
    <svg style="display:none;"><defs><symbol id="icon-moon" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></symbol><symbol id="icon-sun" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></symbol></defs></svg>
<script>
document.addEventListener('DOMContentLoaded',()=>{const e="https://script.google.com/macros/s/AKfycbye3g_cQaj8phduR2Xyh7s9XVed-nTqUgh4V5i6A7NthIx1B7PTsGYGw4iK_VNIvuah1Q/exec",t="85590628331",a={products:[],paymentMethods:[],cart:[],activeCategory:null,activeSubcategory:null,selectedPaymentMethod:null},o=e=>document.getElementById(e),n={productGrid:o("product-grid"),categoryFilters:o("category-filters"),subcategorySection:o("subcategory-section"),subcategoryTitle:o("subcategory-title"),subcategoryFilters:o("subcategory-filters"),productSectionTitle:o("product-section-title"),cartCount:o("cart-count"),modalContainer:o("modal-container"),themeIcon:o("theme-icon-container")},l=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e||0),i={renderPage:()=>{if(!a.activeCategory)return;const e=[...new Set(a.products.filter(e=>e.category===a.activeCategory).map(e=>e.subcategory))];n.subcategorySection.classList.toggle("hidden",!e.length),n.subcategoryTitle.textContent=`Sub-Kategori: ${a.activeCategory}`,n.subcategoryFilters.innerHTML=e.map(e=>`<button class="filter-btn px-3 py-1.5 rounded-lg border" data-action="filter" data-filter-type="subcategory" data-value="${e}">${e}</button>`).join(""),n.productSectionTitle.textContent=`${a.activeCategory} / ${a.activeSubcategory}`;const t=a.products.filter(e=>e.category===a.activeCategory&&e.subcategory===a.activeSubcategory);n.productGrid.innerHTML=t.length?t.map(e=>{const t=(e.image||"").split("|")[0]||"https://placehold.co/400x400/ccc/fff?text=No+Image";return `<div class="bg-white rounded-lg shadow-md overflow-hidden transform hover:-translate-y-1 cursor-pointer" data-action="open-product" data-product-id="${e.id}"><img src="${t}" alt="${e.name}" class="w-full h-56 object-cover" loading="lazy"><div class="p-4"><h3 class="font-bold truncate">${e.name}</h3><p class="text-sm text-gray-500">${e.subcategory}</p><p class="mt-1 font-semibold">${l(e.price)}</p></div></div>`}).join(""):`<p class="col-span-full text-center">Tidak ada produk.</p>`,document.querySelectorAll(".filter-btn").forEach(e=>{const{filterType:t,value:o}=e.dataset,n="category"===t&&o===a.activeCategory||"subcategory"===t&&o===a.activeSubcategory;e.classList.toggle("active",n),e.classList.toggle("bg-blue-500",n),e.classList.toggle("text-white",n)})},updateCartDisplay:()=>{a.cart=JSON.parse(localStorage.getItem("mendozaCart")||"[]"),n.cartCount.textContent=a.cart.reduce((e,t)=>e+t.quantity,0)},openModal:e=>{n.modalContainer.innerHTML=`<div class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop" data-action="close-modal-backdrop">${e}</div>`,document.body.style.overflow="hidden"},closeModal:()=>{n.modalContainer.innerHTML="",document.body.style.overflow="auto"},toggleTheme:e=>{n.themeIcon.setAttribute("href",e?"#icon-sun":"#icon-moon")}},s={open-product:e=>{const t=a.products.find(t=>t.id==e.dataset.productId);if(!t)return;const o=(t.image||"").split("|").filter(e=>e.trim()),n=o.length>1,r=n?`<div class="flex space-x-2 mt-4 p-2 overflow-x-auto">${o.map((e,t)=>`<img src="${e}" alt="Thumb ${t+1}" data-action="gallery-thumb" data-index="${t}" class="thumbnail-image w-16 h-16 object-cover rounded-md ${0===t?"active":""}">`).join("")}</div>`:"",c=n?`<button class="image-nav-btn absolute top-1/2 -translate-y-1/2 left-2 flex items-center justify-center" data-action="gallery-nav" data-direction="-1"><</button><button class="image-nav-btn absolute top-1/2 -translate-y-1/2 right-2 flex items-center justify-center" data-action="gallery-nav" data-direction="1">></button>`:"";i.openModal(`<div class="bg-white dark:bg-slate-800 rounded-lg shadow-2xl w-full max-w-4xl mx-auto modal" data-images='${JSON.stringify(o)}' data-current-index="0"><div class="flex flex-col md:flex-row max-h-[90vh]"><div class="w-full md:w-1/2 p-4 flex flex-col justify-center bg-gray-100 dark:bg-slate-900"><div class="main-image-wrapper relative"><img id="main-product-image" src="${o[0]||"https://placehold.co/600x600/ccc/fff?text=N/A"}" alt="${t.name}" class="w-full h-auto object-contain max-h-[50vh]">${c}</div>${r}</div><div class="p-6 flex flex-col justify-between md:w-1/2 overflow-y-auto"><div><div class="flex justify-between items-start"><h2 class="text-3xl font-bold">${t.name}</h2><button data-action="close-modal" class="text-2xl -mt-2">×</button></div><p class="text-sm bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 px-2 py-1 rounded-full inline-block my-2">${t.category} / ${t.subcategory}</p><p class="text-2xl font-semibold my-2">${l(t.price)}</p><div class="mt-4">${(t.description||"").replace(/\n/g,"<br>")}</div></div><button data-action="add-to-cart" data-product-id="${t.id}" class="w-full bg-blue-500 text-white font-bold py-3 px-4 rounded-lg mt-6 hover:bg-blue-600">Tambah</button></div></div></div>`)},"open-cart":()=>{const e=a.cart.reduce((e,t)=>e+t.price*t.quantity,0),t=a.cart.length?a.cart.map(e=>`<div class="flex justify-between items-center mb-4"><img src="${(e.image||"").split("|")[0]}" alt="${e.name}" class="w-16 h-16 object-cover rounded-md mr-4"><div><h4 class="font-bold">${e.name}</h4><p class="text-sm">${l(e.price)} x ${e.quantity}</p></div><div class="text-right"><span class="font-semibold">${l(e.price*e.quantity)}</span><button data-action="remove-from-cart" data-product-id="${e.id}" class="text-red-500 font-bold text-xl ml-4">×</button></div></div>`).join(""):`<p class="text-center">Keranjang kosong.</p>`;i.openModal(`<div class="bg-white dark:bg-slate-800 rounded-lg shadow-2xl w-full max-w-lg mx-auto modal"><div class="p-6"><div class="flex justify-between items-center border-b pb-4 mb-4"><h3 class="text-2xl font-bold">Keranjang</h3><button data-action="close-modal" class="text-2xl">×</button></div><div class="max-h-80 overflow-y-auto">${t}</div><div class="border-t pt-4 mt-4"><div class="flex justify-between font-bold text-lg"><span>Total</span><span>${l(e)}</span></div><button data-action="go-to-payment" class="w-full bg-blue-500 text-white font-bold py-3 rounded-lg mt-4 ${a.cart.length?"":"opacity-50 cursor-not-allowed"}" ${a.cart.length?"":"disabled"}>Pembayaran</button></div></div></div>`)},"go-to-payment":()=>{if(!a.cart.length)return;i.closeModal(),a.selectedPaymentMethod=null;const e=a.paymentMethods.map(e=>`<div class="payment-option border rounded-lg p-4 cursor-pointer" data-action="select-payment" data-method-id="${e.id}"><label class="flex items-center w-full cursor-pointer"><img src="${e.logo}" class="w-20 h-10 object-contain mr-4" onerror="this.style.display='none'"><div class="flex-grow"><p class="font-bold">${e.name}</p><p class="text-sm">${(e.details||"").replace(/<br>/g," ")}</p></div><div class="radio-check w-5 h-5 border-2 rounded-full ml-4 shrink-0"><div class="w-2.5 h-2.5 bg-blue-500 rounded-full hidden"></div></div></label></div>`).join("");i.openModal(`<div class="bg-white dark:bg-slate-800 rounded-lg w-full max-w-lg mx-auto modal"><div class="p-6"><div class="flex justify-between items-center"><h3 class="text-2xl font-bold">Pilih Pembayaran</h3><button data-action="close-modal" class="text-2xl">×</button></div><div class="space-y-4 mt-6">${e}</div><div id="barcode-display-area" class="mt-4 text-center"></div><div class="pt-4 mt-6 border-t"><button data-action="confirm-payment" class="w-full bg-green-500 text-white font-bold py-3 rounded-lg"><i class="fab fa-whatsapp"></i> Konfirmasi</button></div></div></div>`)},"select-payment":e=>{a.selectedPaymentMethod=a.paymentMethods.find(t=>t.id==e.dataset.methodId),document.querySelectorAll(".payment-option").forEach(e=>{e.classList.remove("selected","border-blue-500"),e.querySelector(".radio-check > div").classList.add("hidden")}),e.classList.add("selected","border-blue-500"),e.querySelector(".radio-check > div").classList.remove("hidden"),o("barcode-display-area").innerHTML=a.selectedPaymentMethod?.barcode?`<p class="font-semibold mb-2 mt-4">Scan:</p><img src="${a.selectedPaymentMethod.barcode}" class="mx-auto max-w-xs rounded-md">`:""},"confirm-payment":()=>{if(!a.selectedPaymentMethod)return void alert("Pilih metode pembayaran.");const e=a.cart.reduce((e,t)=>e+t.price*t.quantity,0);let o=`Halo, saya mau pesan:\n\n${a.cart.map(e=>`*${e.name}*\n(${l(e.price)} x ${e.quantity}) = ${l(e.price*e.quantity)}\n`).join("\n")}*Total: ${l(e)}*\n*Bayar via: ${a.selectedPaymentMethod.name}*\n\nTerima kasih.`;window.open(`https://wa.me/${t}?text=${encodeURIComponent(o)}`,"_blank"),a.cart=[],localStorage.removeItem("mendozaCart"),i.updateCartDisplay(),i.closeModal()},"add-to-cart":e=>{const t=a.products.find(t=>t.id==e.dataset.productId);if(!t)return;const o=a.cart.find(e=>e.id==t.id);o?o.quantity++:a.cart.push({...t,quantity:1}),localStorage.setItem("mendozaCart",JSON.stringify(a.cart)),i.updateCartDisplay(),i.closeModal()},"remove-from-cart":e=>{const t=a.cart.findIndex(t=>t.id==e.dataset.productId);t>-1&&(a.cart[t].quantity--,0===a.cart[t].quantity&&a.cart.splice(t,1)),localStorage.setItem("mendozaCart",JSON.stringify(a.cart)),i.updateCartDisplay(),s["open-cart"]()},'close-modal':i.closeModal,"close-modal-backdrop":e=>{e.target===e.currentTarget&&i.closeModal()},"filter":e=>{const{filterType:t,value:o}=e.dataset;"category"===t?(a.activeCategory=o,a.activeSubcategory=[...new Set(a.products.filter(e=>e.category===a.activeCategory).map(e=>e.subcategory))][0]):a.activeSubcategory=o,i.renderPage()},"gallery-nav":e=>{const t=e.closest(".modal"),a=parseInt(t.dataset.currentIndex),o=parseInt(e.dataset.direction),n=JSON.parse(t.dataset.images),l=(a+o+n.length)%n.length;t.querySelector("#main-product-image").src=n[l],t.dataset.currentIndex=l,t.querySelectorAll(".thumbnail-image").forEach(e=>e.classList.toggle("active",e.dataset.index==l))},"gallery-thumb":e=>{const t=e.closest(".modal"),a=parseInt(e.dataset.index);t.querySelector("#main-product-image").src=JSON.parse(t.dataset.images)[a],t.dataset.currentIndex=a,t.querySelectorAll(".thumbnail-image").forEach(e=>e.classList.toggle("active",e.dataset.index==a))},"toggle-theme":()=>{const e=document.documentElement.classList.toggle("dark");localStorage.setItem("theme",e?"dark":"light"),i.toggleTheme(e)}};document.addEventListener("click",e=>{const t=e.target.closest("[data-action]");t&&s[t.dataset.action]&&(e.preventDefault(),s[t.dataset.action](t))}),async function(){i.updateCartDisplay();const t=document.documentElement.classList.contains("dark");i.toggleTheme(t);try{const t=await fetch(e);if(!t.ok)throw new Error(`HTTP ${t.status}`);const o=await t.json();a.products=o.products||[],a.paymentMethods=o.paymentMethods||[],o("loading-state")?.remove(),a.products.length>0?(n.categoryFilters.innerHTML=[...new Set(a.products.map(e=>e.category))].map(e=>`<button class="filter-btn px-4 py-2 rounded-lg border" data-action="filter" data-filter-type="category" data-value="${e}">${e}</button>`).join(""),a.activeCategory=[...new Set(a.products.map(e=>e.category))][0],a.activeSubcategory=[...new Set(a.products.filter(e=>e.category===a.activeCategory).map(e=>e.subcategory))][0],i.renderPage()):n.productGrid.innerHTML=`<p class="col-span-full text-center">Toko sedang kosong.</p>`}catch(e){console.error("Init failed:",e),n.productGrid.innerHTML=`<p class="col-span-full text-center text-red-500">Gagal memuat produk.</p>`}}()});
</script>
</body><!-- Letakkan ini SEBELUM tag penutup </body> -->
<script src="data.js"></script>
<script>
  // KODE JAVASCRIPT BARU UNTUK INDEX.HTML
  document.addEventListener('DOMContentLoaded', () => {
    // Ambil data dari file data.js, bukan lagi dari API
    const state = {
      products: mendozaData.products || [],
      paymentMethods: mendozaData.paymentMethods || [],
      cart: JSON.parse(localStorage.getItem('mendozaCart') || '[]'),
      activeCategory: null,
      activeSubcategory: null,
    };
    // ... (seluruh logika frontend lainnya akan bekerja dengan data ini) ...
    // Logika lengkap akan saya berikan di pesan berikutnya jika ini berhasil
    console.log("Data berhasil dimuat dari data.js:", state.products.length, "produk ditemukan.");
    document.getElementById('loading-state').remove();
    // Fungsi untuk render halaman akan dipanggil di sini...
  });
</script>
</html>
